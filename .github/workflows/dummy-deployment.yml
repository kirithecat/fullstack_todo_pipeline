name: Dummy deployment pipeline
on: push
jobs:
  Deploy-to-Test:
    runs-on: ubuntu-latest
    steps:
      - run: echo "ðŸ”Ž The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}." 

  Test-Environment:
    needs: [Deploy-to-Test]
    runs-on: ubuntu-latest
    env:
      NODE_ENV: "default"
    steps:
      - uses: ./.github/workflows/run-test-suite-workflow.yml

  Deploy-to-Staging:
    needs: [Test-Environment]
    runs-on: ubuntu-latest
    steps:
      - run: echo "ðŸ”Ž The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}." 
  
  Staging-Environment:
    needs: [Deploy-to-Staging]
    uses: ./.github/workflows/run-test-suite-workflow.yml

  Deploy-to-Production:
    needs: [Staging-Environment]
    runs-on: ubuntu-latest
    steps:
      - uses: trstringer/manual-approval@v1
        with:
          secret: ${{ github.TOKEN }}
          approvers: kirithecat
          minimum-approvals: 1
          issue-title: "Deploying v1.3.5 to prod from staging"
          issue-body: "Please approve or deny the deployment of version v1.3.5."
          exclude-workflow-initiator-as-approver: false
          additional-approved-words: ''
          additional-denied-words: ''
      - run: echo "ðŸ”Ž The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}." 
  
  Production-Environment:
    needs: [Deploy-to-Production]
    uses: ./.github/workflows/run-test-suite-workflow.yml
  